
ï»¿var ignore=false;var g_TimeOutID=0;var g_nSessionTimeout=15;var g_SessionDate=new Date();var __setOption=$.ui.dialog.prototype._setOption;$.extend($.ui.dialog.prototype,{_setOption:function(key,value){var self=this,uiDialog=self.uiDialog;if(key==='body'){self.element.html(""+(value||'&#160;'));}
__setOption.apply(self,arguments);}});function getUrlVars(){var vars={};var parts=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value){vars[key]=value;});return vars;}
jQuery(document).ready(function(){BuildDefaultLoader();$(":submit").click(function(){if(!ignore&&$(this).attr('target')==null&&$(this).attr('role')!='button'){$("#window").dialog("open");ignore=false;}});$(":button").click(function(){if(!ignore&&$(this).attr('target')==null&&$(this).attr('role')!='button'){if($(this).attr('role')=='payment'){BuildPaymentLoader();$("#pwindow").dialog("open");ignore=false;}else{$("#window").dialog("open");ignore=false;}}});$("a").click(function(){if(!ignore&&$(this).attr('target')==null&&$(this).attr('role')!='button'){$("#window").dialog("open");ignore=false;}});$(".ui-dialog-titlebar-close").click(function(){$("#window").dialog("close");});function tabDisplay(tabSelected,tabGroup,selected){var collapse=false;if($(".tab[group="+tabGroup+"][body="+tabSelected+"]").hasClass('collapse')){if($(".tab[group="+tabGroup+"][body="+tabSelected+"]").hasClass('selected')){collapse=true;}}
$(".tab[group="+tabGroup+"]").removeClass("selected");$(".tab-mobi[group="+tabGroup+"]").removeClass("selected");$(".tab-content[group="+tabGroup+"]").removeClass("displaydiv");if(collapse){$(".tab[group="+tabGroup+"][body="+tabSelected+"]").removeClass("selected");$(".tab-mobi[group="+tabGroup+"][body="+tabSelected+"]").removeClass("selected");$(".tab-content[group="+tabGroup+"][id="+tabSelected+"]").removeClass("displaydiv");}else{$(".tab[group="+tabGroup+"][body="+tabSelected+"]").addClass("selected");$(".tab-mobi[group="+tabGroup+"][body="+tabSelected+"]").addClass("selected");$(".tab-content[group="+tabGroup+"][id="+tabSelected+"]").addClass("displaydiv");if($(window).width()<600){$('html, body').animate({scrollTop:$(selected).offset().top},'slow');}}}
$(".tab,.tab-mobi").click(function(){tab=$(this).attr('body');group=$(this).attr('group');selected=$(this);tabDisplay(tab,group,selected);});var urlTab=getUrlVars()["tab"];if(urlTab){var urlTabGroup=getUrlVars()["tab-group"];tabDisplay(urlTab,urlTabGroup,".tab");}
function maximizeSelector(){$('.selector').removeClass('mini');$('.btn-expand').html('<span class="icon"></span>Minimize');}
$(".widget-selector-widget .display-one,.greyed-search-btn").click(function(){maximizeSelector();});$("#ddlArrivalAirport,#ddlDepartureAirport").focus(function(){maximizeSelector();});$(".btn-expand").click(function(){if($(".selector").hasClass("mini")){maximizeSelector();}else{$('.selector').addClass('mini');$('.btn-expand').html('<span class="icon"></span>Expand');}});$(".ico-search").click(function(){if($("#layout-navigation").hasClass("search - focused")){$("#layout-navigation").removeClass("search-focused");}else{$("#layout-navigation").addClass("search-focused");$("#q").focus();}});$(".ico-menu").click(function(){$("#layout-navigation").removeClass("search-focused");});$('.dropdown-menu li[data-toggle="tab"], .dropdown-menu div.tab-mobi[data-toggle="tab"]').click(function(e){e.stopPropagation()
$(this).tab('show');})
fixCurrency();});function fixCurrency(id)
{var valueCollection=$(".currencyvalue");if(id){valueCollection=$("#"+id+".currencyvalue");}else{}
$(valueCollection).each(function(){var amount=$(this).attr("data-amount");amount=parseFloat(amount);var rand="";var cents="";if(isNaN(amount)==false){var amountString=amount.toFixed(2);var parts=amountString.split('.');rand=parts[0];cents=parts[1];}else{return;}
var expression="<span class='price'><span class='currency'>R</span>"+rand+"<span class='cents'>"+'.'+cents+"</span ></span>"
$(this).html(expression);});}
function BuildDefaultLoader(){var d=document.createElement("div");d.id="window";d.style.display='none';document.body.appendChild(d);$("#window").dialog({open:function(){SetLoading();},autoOpen:false,width:300,height:160,modal:true,resizable:false});}
function BuildPaymentLoader(){var p=document.createElement("div");p.id="pwindow";p.style.display='none';document.body.appendChild(p);$("#pwindow").dialog({open:function(){SetPaymentLoading();},autoOpen:false,width:300,height:300,modal:true,resizable:false});}
function SetLoading(){$("#window").dialog({title:'',body:'<div class="loader"><img src="/Themes/kulula-responsive/Content/loader/k-loader-v00.gif" class="plane-loader" /><span>Loading...</span></div><div class="loader-text">Please wait while we process your request.</div>'});}
function SetPaymentLoading(){$("#pwindow").dialog({title:'',body:'<div class="loader"><img src="/Themes/kulula-responsive/Content/loader/k-loader-v00.gif" class="plane-loader" /><span>Loading...</span></div><div class="loader-text"><b>Please wait while we process your request.</b><br /><br />If you\'ve been hypnotised by our spinner for more than 5 minutes <b>do not try to rebook</b>, rather call our Contact Centre on 0861 KULULA (585852) to confirm the status of your booking and if payment has been processed.</div>'});}
function alertObject(o){var out='';for(var p in o){out+=p+': '+o[p]+'\n';}
alert(out);}
var popUpDiv=document.createElement("div");popUpDiv.id="popupdiv";popUpDiv.style.display='none';document.body.appendChild(popUpDiv);$("#popupdiv").dialog({open:function(){},autoOpen:false,width:300,height:160,modal:true,resizable:false,dialogClass:'hide-close-dialog'});function closePopUp(){$("#popupdiv").dialog("close");}
function closeModifySearch()
{$('#modifysearchextend').slideToggle(500);}
function ShowPopUp(header,body,height,width,draggable,hideclosebutton,modify){if(height!=null){$("#popupdiv").dialog('option','height',height);}
if(width!=null){$("#popupdiv").dialog('option','width',width);}
if(draggable!=null){$("#popupdiv").dialog('option','draggable',draggable);}
$("#popupdiv").dialog('option','title',header);$("#popupdiv").dialog('option','body',body);if(modify!=null){jQuery("#popupdiv").dialog({open:function(event,ui){$(event.target).parent().css('top','120px');}});}
if(hideclosebutton){$('.hide-close-dialog').find('.ui-dialog-titlebar-close').css('display','none');}
$("#popupdiv").dialog("open");}
(function(wnd,$,undefined){var $dlg=$("#popupdiv").parent(),$wnd=$(wnd),initialTop=$dlg.offset().top-$wnd.scrollTop();$wnd.scroll(function(){$dlg.stop().animate({"top":($wnd.scrollTop()+initialTop)+"px"},"slow");}).resize(function(){initialTop=$dlg.offset().top-$wnd.scrollTop();});$dlg.bind('dialogcreate dialogopen',function(e){initialTop=$dlg.offset().top-$wnd.scrollTop();});})(window,jQuery);function closeError(){$("#popupdiv").dialog("close");}
function showError(message,height,width,type){showError(message,height,width,null);}
function showError(message,height,width,type,url){if(height!=null){$("#popupdiv").dialog('option','height',height);}
if(width!=null){$("#popupdiv").dialog('option','width',width);}
var body='';var defaultUrl='';switch(type){case"ce":body+='<div class="error-critical">[MESSAGE]<br /><div class="div-btn"><a class="content-btn" href="[URL]">start again</a></div></div>';defaultUrl="/";break;case"e":body+='<div class="error-retry">[MESSAGE]<br /><div class="div-btn"><a class="content-btn" role="button" href="[URL]">ok</a></div></div>';defaultUrl='javascript:closeError();';break;default:body+='[MESSAGE]';}
if(url==null)
{url=defaultUrl;}
body=body.replace('[URL]',url);body=body.replace('[MESSAGE]',message);$("#popupdiv").dialog('option','title','Please note');$("#popupdiv").dialog('option','body',body);$("#popupdiv").dialog("open");}
var eBucks={validateLogin:function(){var isValid=true;setErrorMsg("");isValid=isValid&&checkRegexp($("#memberIdentifier"),/^([0-9]{13,16})$/,"Invalid number. Please enter a valid South African ID or eBucks card number to continue.");isValid=isValid&&checkRegexp($("#pin"),/^([0-9]{4})$/,"Invalid PIN. Please re-enter your 4-digit security PIN.");return isValid;}}
var customerInsight={validateLogin:function(){var isValid=true;setErrorMsg("");isValid=isValid&&checkforblank($("#username"),"Please enter a username.");isValid=isValid&&checkforblank($("#password"),"Please enter a password.");return isValid;}}
function checkRegexp(obj,regexp,n){if(!(regexp.test(obj.val()))){setErrorMsg(n);return false;}
else{return true;}}
function checkforblank(obj,n){if($.trim(obj.val())==""){setErrorMsg(n);return false;}
else{return true;}}
function setErrorMsg(msg){if(!msg){$("#validationErrMsg").hide();}else{$("#validationErrMsg").text(msg);$("#validationErrMsg").show();}}
function stop(){window.status='';clearTimeout(g_TimeOutID);}
function resetTimer(){window.status='';g_SessionDate=new Date();g_SessionDate.setMinutes((g_SessionDate.getMinutes()+g_nSessionTimeout)-1,59);sessionTimer();}
function sessionTimer(){try{if(g_nSessionTimeout!=0){var d=new Date();var win='Your session will expire in approximately ';if(g_SessionDate>d){var s=Math.round((g_SessionDate-d)/1000);if(s>59){if(Math.round(s/60)<=5&&(s%10)==0)window.status=win+(Math.round(s/60)+1)+' minute(s)';}
else{window.status=win+s+' seconds';}
g_TimeOutID=setTimeout('sessionTimer()',1000);}
else{window.status='Your session has been disconnected';top.location.href='/session/timedout';}}}
catch(e){}}
function logOutVitality(){try{top.location.href='/comair.kulula/Account/VitalityLogOff';}
catch(e){}}
var JSON;if(!JSON){JSON={};}
(function(){'use strict';function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}}());